#!/bin/bash
# 50,000개 레시피 대규모 수집 스크립트

set -e

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd "$SCRIPT_DIR/../.."

# 색상
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m'

# 로그 함수
log_info() { echo -e "${BLUE}[INFO]${NC} $1"; }
log_success() { echo -e "${GREEN}[✓]${NC} $1"; }
log_warning() { echo -e "${YELLOW}[!]${NC} $1"; }
log_error() { echo -e "${RED}[✗]${NC} $1"; }

# 환경 체크
if [ ! -f "config/.env" ]; then
    log_error "config/.env not found!"
    exit 1
fi

if [ ! -d "venv" ]; then
    log_error "venv not found!"
    exit 1
fi

# Virtual env 활성화
source venv/bin/activate

# PostgreSQL 비밀번호 환경변수 설정
export PGPASSWORD='wkwjsrj4510*'

log_info "=========================================="
log_info "  🚀 50,000개 레시피 대규모 수집"
log_info "=========================================="

# 현재 DB 레시피 수 확인
CURRENT_COUNT=$(psql -h localhost -d recipe_ai_db -U recipe_keep -t -c "SELECT COUNT(*) FROM recipes;" 2>/dev/null | tr -d ' ')
log_info "현재 DB 레시피 수: ${CURRENT_COUNT}개"
log_info ""

# DB 초기화 확인
read -p "DB를 초기화하고 시작하시겠습니까? (y/N): " reset_db
if [[ $reset_db =~ ^[Yy]$ ]]; then
    log_info "DB 초기화 중..."
    psql -h localhost -d recipe_ai_db -U recipe_keep -c "TRUNCATE recipes CASCADE;" 2>&1 | grep -v "^$"
    log_success "DB 초기화 완료"
fi

# 50,000개 수집 배열 (500개 배치 × 100개 = 50,000개)
declare -a COLLECTIONS=(
    # ===== Phase 1: 한식 메인 요리 (5,000개) =====
    # 소고기 (1,000개)
    "1-1:소고기볶음:밑반찬:일상:소고기:볶음:100"
    "1-2:소고기구이:밑반찬:일상:소고기:구이:100"
    "1-3:소고기조림:밑반찬:일상:소고기:조림:100"
    "1-4:소고기찜:밑반찬:일상:소고기:찜:100"
    "1-5:소고기무침:밑반찬:일상:소고기:무침:100"
    "1-6:소고기국:국/탕:일상:소고기:끓이기:100"
    "1-7:소고기전골:국/탕:일상:소고기:끓이기:100"
    "1-8:소고기장조림:밑반찬:일상:소고기:조림:100"
    "1-9:소고기불고기:밑반찬:일상:소고기:볶음:100"
    "1-10:소고기육회:밑반찬:일상:소고기:무침:100"
    
    # 돼지고기 (1,000개)
    "1-11:돼지고기볶음:밑반찬:일상:돼지고기:볶음:100"
    "1-12:돼지고기구이:밑반찬:일상:돼지고기:구이:100"
    "1-13:돼지고기찜:밑반찬:일상:돼지고기:찜:100"
    "1-14:돼지고기조림:밑반찬:일상:돼지고기:조림:100"
    "1-15:삼겹살:밑반찬:일상:돼지고기:굽기:100"
    "1-16:목살구이:밑반찬:일상:돼지고기:구이:100"
    "1-17:돼지갈비:밑반찬:일상:돼지고기:구이:100"
    "1-18:보쌈:찜:일상:돼지고기:삶기:100"
    "1-19:족발:찜:일상:돼지고기:삶기:100"
    "1-20:수육:찜:일상:돼지고기:삶기:100"
    
    # 닭고기 (1,000개)
    "1-21:닭고기구이:밑반찬:일상:닭고기:구이:100"
    "1-22:닭고기조림:밑반찬:일상:닭고기:조림:100"
    "1-23:닭고기볶음:밑반찬:일상:닭고기:볶음:100"
    "1-24:닭고기튀김:밑반찬:일상:닭고기:튀김:100"
    "1-25:닭가슴살:밑반찬:초스피드:닭고기:볶음:100"
    "1-26:삼계탕:국/탕:일상:닭고기:끓이기:100"
    "1-27:닭찜:찜:일상:닭고기:찜:100"
    "1-28:닭강정:튀김:일상:닭고기:튀김:100"
    "1-29:닭볶음탕:찜:일상:닭고기:볶음:100"
    "1-30:치킨:튀김:일상:닭고기:튀김:100"
    
    # 해산물 (2,000개)
    "1-31:생선구이:밑반찬:일상:생선류:구이:100"
    "1-32:생선조림:밑반찬:일상:생선류:조림:100"
    "1-33:생선찜:찜:일상:생선류:찜:100"
    "1-34:생선튀김:튀김:일상:생선류:튀김:100"
    "1-35:오징어볶음:밑반찬:일상:오징어:볶음:100"
    "1-36:오징어순대:밑반찬:일상:오징어:찜:100"
    "1-37:낙지볶음:밑반찬:일상:낙지:볶음:100"
    "1-38:낙지연포탕:국/탕:일상:낙지:끓이기:100"
    "1-39:새우볶음:밑반찬:일상:새우:볶음:100"
    "1-40:새우튀김:튀김:일상:새우:튀김:100"
    "1-41:조개찜:밑반찬:일상:조개류:찜:100"
    "1-42:조개구이:밑반찬:일상:조개류:구이:100"
    "1-43:전복요리:밑반찬:일상:전복:찜:100"
    "1-44:전복죽:일품요리:일상:전복:끓이기:100"
    "1-45:문어숙회:밑반찬:일상:문어:삶기:100"
    "1-46:해파리냉채:밑반찬:일상:해파리:무침:100"
    "1-47:멍게:밑반찬:일상:멍게:무침:100"
    "1-48:게장:밑반찬:일상:게:절임:100"
    "1-49:꽃게찜:찜:일상:게:찜:100"
    "1-50:대게찜:찜:일상:게:찜:100"
    
    # ===== Phase 2: 채소 요리 (5,000개) =====
    # 두부 (500개)
    "2-1:두부조림:밑반찬:일상:두부:조림:100"
    "2-2:두부볶음:밑반찬:일상:두부:볶음:100"
    "2-3:두부구이:밑반찬:일상:두부:구이:100"
    "2-4:두부찌개:찌개:일상:두부:끓이기:100"
    "2-5:순두부찌개:찌개:일상:두부:끓이기:100"
    
    # 버섯 (500개)
    "2-6:버섯볶음:밑반찬:일상:버섯:볶음:100"
    "2-7:표고버섯조림:밑반찬:일상:버섯:조림:100"
    "2-8:새송이버섯구이:밑반찬:일상:버섯:구이:100"
    "2-9:느타리버섯:밑반찬:일상:버섯:볶음:100"
    "2-10:양송이버섯:밑반찬:일상:버섯:볶음:100"
    
    # 가지/호박/오이 (1,000개)
    "2-11:가지볶음:밑반찬:일상:가지:볶음:100"
    "2-12:가지나물:밑반찬:일상:가지:찜:100"
    "2-13:호박볶음:밑반찬:일상:호박:볶음:100"
    "2-14:애호박나물:밑반찬:일상:호박:볶음:100"
    "2-15:호박전:부침:일상:호박:부침:100"
    "2-16:오이무침:밑반찬:초스피드:오이:무침:100"
    "2-17:오이냉국:국/탕:초스피드:오이:만들기:100"
    "2-18:오이소박이:김치:일상:오이:절임:100"
    "2-19:오이장아찌:밑반찬:일상:오이:절임:100"
    "2-20:오이선:밑반찬:일상:오이:찜:100"
    
    # 감자/고구마 (500개)
    "2-21:감자조림:밑반찬:일상:감자:조림:100"
    "2-22:감자볶음:밑반찬:일상:감자:볶음:100"
    "2-23:감자전:부침:일상:감자:부침:100"
    "2-24:감자샐러드:밑반찬:일상:감자:무침:100"
    "2-25:고구마요리:밑반찬:일상:고구마:찜:100"
    
    # 나물류 (2,500개)
    "2-26:콩나물무침:밑반찬:초스피드:콩나물:무침:100"
    "2-27:콩나물국:국/탕:초스피드:콩나물:끓이기:100"
    "2-28:시금치나물:밑반찬:초스피드:시금치:무침:100"
    "2-29:시금치된장국:국/탕:일상:시금치:끓이기:100"
    "2-30:파무침:밑반찬:초스피드:파:무침:100"
    "2-31:파김치:김치:일상:파:절임:100"
    "2-32:고사리나물:밑반찬:일상:고사리:볶음:100"
    "2-33:도라지무침:밑반찬:일상:도라지:무침:100"
    "2-34:더덕구이:밑반찬:일상:더덕:구이:100"
    "2-35:마늘종볶음:밑반찬:일상:마늘종:볶음:100"
    "2-36:청경채볶음:밑반찬:초스피드:청경채:볶음:100"
    "2-37:쑥갓무침:밑반찬:초스피드:쑥갓:무침:100"
    "2-38:취나물:밑반찬:일상:취나물:볶음:100"
    "2-39:냉이나물:밑반찬:일상:냉이:무침:100"
    "2-40:달래무침:밑반찬:초스피드:달래:무침:100"
    "2-41:부추무침:밑반찬:초스피드:부추:무침:100"
    "2-42:부추전:부침:일상:부추:부침:100"
    "2-43:상추겉절이:밑반찬:초스피드:상추:무침:100"
    "2-44:배추겉절이:밑반찬:초스피드:배추:무침:100"
    "2-45:미나리무침:밑반찬:초스피드:미나리:무침:100"
    "2-46:숙주나물:밑반찬:초스피드:숙주:무침:100"
    "2-47:깻잎무침:밑반찬:초스피드:깻잎:무침:100"
    "2-48:깻잎찜:밑반찬:일상:깻잎:찜:100"
    "2-49:깻잎장아찌:밑반찬:일상:깻잎:절임:100"
    "2-50:브로콜리:밑반찬:초스피드:브로콜리:삶기:100"
    
    # ===== Phase 3: 밥/면/일품 (10,000개) =====
    # 볶음밥 (1,000개)
    "3-1:김치볶음밥:일품요리:일상:김치:볶음:100"
    "3-2:소고기볶음밥:일품요리:일상:소고기:볶음:100"
    "3-3:새우볶음밥:일품요리:일상:새우:볶음:100"
    "3-4:야채볶음밥:일품요리:초스피드:야채:볶음:100"
    "3-5:참치볶음밥:일품요리:초스피드:참치:볶음:100"
    "3-6:계란볶음밥:일품요리:초스피드:계란:볶음:100"
    "3-7:베이컨볶음밥:일품요리:일상:베이컨:볶음:100"
    "3-8:햄볶음밥:일품요리:초스피드:햄:볶음:100"
    "3-9:볶음밥:일품요리:초스피드:밥:볶음:100"
    "3-10:중국집볶음밥:일품요리:일상:밥:볶음:100"
    
    # 덮밥/비빔밥 (1,500개)
    "3-11:소고기덮밥:일품요리:일상:소고기:볶음:100"
    "3-12:돼지고기덮밥:일품요리:일상:돼지고기:볶음:100"
    "3-13:닭고기덮밥:일품요리:일상:닭고기:볶음:100"
    "3-14:야채덮밥:일품요리:초스피드:야채:볶음:100"
    "3-15:참치덮밥:일품요리:초스피드:참치:만들기:100"
    "3-16:계란덮밥:일품요리:초스피드:계란:볶음:100"
    "3-17:비빔밥:일품요리:일상:밥:무침:100"
    "3-18:돌솥비빔밥:일품요리:일상:밥:무침:100"
    "3-19:전주비빔밥:일품요리:일상:밥:무침:100"
    "3-20:산채비빔밥:일품요리:일상:밥:무침:100"
    "3-21:회덮밥:일품요리:일상:회:무침:100"
    "3-22:낙지덮밥:일품요리:일상:낙지:볶음:100"
    "3-23:오징어덮밥:일품요리:일상:오징어:볶음:100"
    "3-24:제육덮밥:일품요리:일상:돼지고기:볶음:100"
    "3-25:김치덮밥:일품요리:초스피드:김치:볶음:100"
    
    # 국수/면 (3,000개)
    "3-26:잔치국수:일품요리:일상:면:끓이기:100"
    "3-27:비빔국수:일품요리:초스피드:면:무침:100"
    "3-28:칼국수:일품요리:일상:면:끓이기:100"
    "3-29:수제비:일품요리:일상:밀가루:끓이기:100"
    "3-30:냉면:일품요리:일상:면:만들기:100"
    "3-31:물냉면:일품요리:일상:면:만들기:100"
    "3-32:비빔냉면:일품요리:일상:면:무침:100"
    "3-33:막국수:일품요리:일상:면:무침:100"
    "3-34:쫄면:일품요리:일상:면:무침:100"
    "3-35:냉국수:일품요리:초스피드:면:만들기:100"
    "3-36:라면:일품요리:초스피드:면:끓이기:100"
    "3-37:떡라면:일품요리:초스피드:면:끓이기:100"
    "3-38:치즈라면:일품요리:초스피드:면:끓이기:100"
    "3-39:짜파게티:일품요리:초스피드:면:볶음:100"
    "3-40:짜장면:일품요리:일상:면:볶음:100"
    "3-41:짬뽕:일품요리:일상:면:끓이기:100"
    "3-42:우동:일품요리:일상:면:끓이기:100"
    "3-43:야끼우동:일품요리:일상:면:볶음:100"
    "3-44:볶음우동:일품요리:일상:면:볶음:100"
    "3-45:쌀국수:일품요리:일상:면:끓이기:100"
    "3-46:파스타:일품요리:일상:파스타:볶음:100"
    "3-47:스파게티:일품요리:일상:파스타:볶음:100"
    "3-48:까르보나라:일품요리:일상:파스타:볶음:100"
    "3-49:토마토파스타:일품요리:일상:파스타:볶음:100"
    "3-50:크림파스타:일품요리:일상:파스타:볶음:100"
    "3-51:알리오올리오:일품요리:일상:파스타:볶음:100"
    "3-52:봉골레파스타:일품요리:일상:파스타:볶음:100"
    "3-53:로제파스타:일품요리:일상:파스타:볶음:100"
    "3-54:새우파스타:일품요리:일상:파스타:볶음:100"
    "3-55:해물파스타:일품요리:일상:파스타:볶음:100"
    
    # 죽/밥 (2,000개)
    "3-56:전복죽:일품요리:일상:전복:끓이기:100"
    "3-57:잣죽:일품요리:일상:잣:끓이기:100"
    "3-58:호박죽:일품요리:일상:호박:끓이기:100"
    "3-59:팥죽:일품요리:일상:팥:끓이기:100"
    "3-60:흑임자죽:일품요리:일상:흑임자:끓이기:100"
    "3-61:야채죽:일품요리:일상:야채:끓이기:100"
    "3-62:닭죽:일품요리:일상:닭고기:끓이기:100"
    "3-63:소고기죽:일품요리:일상:소고기:끓이기:100"
    "3-64:해물죽:일품요리:일상:해물:끓이기:100"
    "3-65:버섯죽:일품요리:일상:버섯:끓이기:100"
    "3-66:계란죽:일품요리:초스피드:계란:끓이기:100"
    "3-67:참치죽:일품요리:초스피드:참치:끓이기:100"
    "3-68:김치죽:일품요리:일상:김치:끓이기:100"
    "3-69:쌀밥:일품요리:초스피드:쌀:짓기:100"
    "3-70:잡곡밥:일품요리:일상:잡곡:짓기:100"
    "3-71:현미밥:일품요리:일상:현미:짓기:100"
    "3-72:보리밥:일품요리:일상:보리:짓기:100"
    "3-73:콩밥:일품요리:일상:콩:짓기:100"
    "3-74:영양밥:일품요리:일상:밥:짓기:100"
    "3-75:약밥:일품요리:일상:밥:짓기:100"
    
    # 기타 일품 (2,500개)
    "3-76:떡볶이:일품요리:초스피드:떡:볶음:100"
    "3-77:치즈떡볶이:일품요리:초스피드:떡:볶음:100"
    "3-78:국물떡볶이:일품요리:초스피드:떡:끓이기:100"
    "3-79:로제떡볶이:일품요리:일상:떡:볶음:100"
    "3-80:김밥:일품요리:일상:김:만들기:100"
    "3-81:참치김밥:일품요리:일상:김:만들기:100"
    "3-82:치즈김밥:일품요리:일상:김:만들기:100"
    "3-83:야채김밥:일품요리:일상:김:만들기:100"
    "3-84:소고기김밥:일품요리:일상:김:만들기:100"
    "3-85:만두:일품요리:일상:만두:찜:100"
    "3-86:군만두:일품요리:일상:만두:굽기:100"
    "3-87:물만두:일품요리:일상:만두:삶기:100"
    "3-88:찐만두:일품요리:일상:만두:찜:100"
    "3-89:왕만두:일품요리:일상:만두:찜:100"
    "3-90:교자:일품요리:일상:만두:굽기:100"
    "3-91:샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-92:계란샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-93:참치샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-94:야채샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-95:BLT샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-96:햄샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-97:치즈샌드위치:일품요리:초스피드:빵:만들기:100"
    "3-98:토스트:일품요리:초스피드:빵:굽기:100"
    "3-99:프렌치토스트:일품요리:초스피드:빵:굽기:100"
    "3-100:샐러드:일품요리:초스피드:야채:무침:100"
    
    # ===== Phase 4: 국/탕/찌개 (10,000개) =====
    # 소고기 국/탕 (2,000개)
    "4-1:소고기국:국/탕:일상:소고기:끓이기:100"
    "4-2:소고기무국:국/탕:일상:소고기:끓이기:100"
    "4-3:소고기미역국:국/탕:일상:소고기:끓이기:100"
    "4-4:소고기뭇국:국/탕:일상:소고기:끓이기:100"
    "4-5:육개장:국/탕:일상:소고기:끓이기:100"
    "4-6:갈비탕:국/탕:일상:소고기:끓이기:100"
    "4-7:설렁탕:국/탕:일상:소고기:끓이기:100"
    "4-8:곰탕:국/탕:일상:소고기:끓이기:100"
    "4-9:갈비찜탕:국/탕:일상:소고기:끓이기:100"
    "4-10:소꼬리탕:국/탕:일상:소고기:끓이기:100"
    "4-11:우거지국:국/탕:일상:소고기:끓이기:100"
    "4-12:콩나물국밥:국/탕:일상:소고기:끓이기:100"
    "4-13:선지국:국/탕:일상:소고기:끓이기:100"
    "4-14:북어국:국/탕:일상:소고기:끓이기:100"
    "4-15:소고기버섯전골:국/탕:일상:소고기:끓이기:100"
    "4-16:해장국:국/탕:일상:소고기:끓이기:100"
    "4-17:뼈해장국:국/탕:일상:소고기:끓이기:100"
    "4-18:사골국:국/탕:일상:소고기:끓이기:100"
    "4-19:도가니탕:국/탕:일상:소고기:끓이기:100"
    "4-20:양지탕:국/탕:일상:소고기:끓이기:100"
    
    # 돼지고기 국/탕 (1,500개)
    "4-21:돼지고기국:국/탕:일상:돼지고기:끓이기:100"
    "4-22:돼지고기김치국:국/탕:일상:돼지고기:끓이기:100"
    "4-23:감자탕:국/탕:일상:돼지고기:끓이기:100"
    "4-24:뼈다귀해장국:국/탕:일상:돼지고기:끓이기:100"
    "4-25:돼지갈비탕:국/탕:일상:돼지고기:끓이기:100"
    "4-26:순대국:국/탕:일상:순대:끓이기:100"
    "4-27:내장탕:국/탕:일상:돼지고기:끓이기:100"
    "4-28:콩나물돼지국밥:국/탕:일상:돼지고기:끓이기:100"
    "4-29:등뼈해장국:국/탕:일상:돼지고기:끓이기:100"
    "4-30:돼지고기전골:국/탕:일상:돼지고기:끓이기:100"
    "4-31:제육국:국/탕:일상:돼지고기:끓이기:100"
    "4-32:김치찌개국:국/탕:일상:돼지고기:끓이기:100"
    "4-33:두루치기국:국/탕:일상:돼지고기:끓이기:100"
    "4-34:고추장찌개국:국/탕:일상:돼지고기:끓이기:100"
    "4-35:대창국밥:국/탕:일상:돼지고기:끓이기:100"
    
    # 닭고기 국/탕 (1,000개)
    "4-36:삼계탕:국/탕:일상:닭고기:끓이기:100"
    "4-37:닭곰탕:국/탕:일상:닭고기:끓이기:100"
    "4-38:닭개장:국/탕:일상:닭고기:끓이기:100"
    "4-39:닭백숙:국/탕:일상:닭고기:끓이기:100"
    "4-40:영계백숙:국/탕:일상:닭고기:끓이기:100"
    "4-41:닭죽:국/탕:일상:닭고기:끓이기:100"
    "4-42:닭칼국수:국/탕:일상:닭고기:끓이기:100"
    "4-43:닭우동:국/탕:일상:닭고기:끓이기:100"
    "4-44:닭국수:국/탕:일상:닭고기:끓이기:100"
    "4-45:닭한마리:국/탕:일상:닭고기:끓이기:100"
    
    # 해산물 국/탕 (2,500개)
    "4-46:생선국:국/탕:일상:생선류:끓이기:100"
    "4-47:동태찌개:국/탕:일상:생선류:끓이기:100"
    "4-48:북어국:국/탕:일상:생선류:끓이기:100"
    "4-49:대구탕:국/탕:일상:생선류:끓이기:100"
    "4-50:명태탕:국/탕:일상:생선류:끓이기:100"
    "4-51:도미탕:국/탕:일상:생선류:끓이기:100"
    "4-52:조기탕:국/탕:일상:생선류:끓이기:100"
    "4-53:갈치조림국:국/탕:일상:생선류:끓이기:100"
    "4-54:고등어조림국:국/탕:일상:생선류:끓이기:100"
    "4-55:꽁치찌개:국/탕:일상:생선류:끓이기:100"
    "4-56:조개국:국/탕:일상:조개류:끓이기:100"
    "4-57:바지락국:국/탕:일상:조개류:끓이기:100"
    "4-58:재첩국:국/탕:일상:조개류:끓이기:100"
    "4-59:홍합탕:국/탕:일상:조개류:끓이기:100"
    "4-60:전복죽국:국/탕:일상:전복:끓이기:100"
    "4-61:굴국:국/탕:일상:굴:끓이기:100"
    "4-62:새우탕:국/탕:일상:새우:끓이기:100"
    "4-63:게탕:국/탕:일상:게:끓이기:100"
    "4-64:낙지탕:국/탕:일상:낙지:끓이기:100"
    "4-65:오징어국:국/탕:일상:오징어:끓이기:100"
    "4-66:해물탕:국/탕:일상:해물:끓이기:100"
    "4-67:해물전골:국/탕:일상:해물:끓이기:100"
    "4-68:아귀찜탕:국/탕:일상:아귀:끓이기:100"
    "4-69:복어탕:국/탕:일상:복어:끓이기:100"
    "4-70:추어탕:국/탕:일상:미꾸라지:끓이기:100"
    
    # 채소 국/탕 (1,000개)
    "4-71:미역국:국/탕:일상:미역:끓이기:100"
    "4-72:된장국:국/탕:일상:된장:끓이기:100"
    "4-73:콩나물국:국/탕:초스피드:콩나물:끓이기:100"
    "4-74:시래기국:국/탕:일상:시래기:끓이기:100"
    "4-75:배추국:국/탕:일상:배추:끓이기:100"
    "4-76:무국:국/탕:일상:무:끓이기:100"
    "4-77:아욱국:국/탕:일상:아욱:끓이기:100"
    "4-78:시금치국:국/탕:일상:시금치:끓이기:100"
    "4-79:호박국:국/탕:일상:호박:끓이기:100"
    "4-80:계란국:국/탕:초스피드:계란:끓이기:100"
    
    # 찌개 (2,000개)
    "4-81:김치찌개:찌개:일상:김치:끓이기:100"
    "4-82:된장찌개:찌개:일상:된장:끓이기:100"
    "4-83:순두부찌개:찌개:일상:두부:끓이기:100"
    "4-84:부대찌개:찌개:일상:소시지:끓이기:100"
    "4-85:청국장찌개:찌개:일상:청국장:끓이기:100"
    "4-86:고추장찌개:찌개:일상:고추장:끓이기:100"
    "4-87:해물찌개:찌개:일상:해물:끓이기:100"
    "4-88:생선찌개:찌개:일상:생선류:끓이기:100"
    "4-89:동태찌개:찌개:일상:생선류:끓이기:100"
    "4-90:버섯찌개:찌개:일상:버섯:끓이기:100"
    "4-91:참치찌개:찌개:초스피드:참치:끓이기:100"
    "4-92:두부찌개:찌개:일상:두부:끓이기:100"
    "4-93:콩비지찌개:찌개:일상:콩:끓이기:100"
    "4-94:떡만두국:국/탕:일상:떡:끓이기:100"
    "4-95:만둣국:국/탕:일상:만두:끓이기:100"
    "4-96:떡국:국/탕:일상:떡:끓이기:100"
    "4-97:떡볶이국:국/탕:일상:떡:끓이기:100"
    "4-98:라면찌개:찌개:초스피드:면:끓이기:100"
    "4-99:치즈찌개:찌개:초스피드:치즈:끓이기:100"
    "4-100:된장찌개버섯:찌개:일상:된장:끓이기:100"
    
    # ===== Phase 5: 특수 요리 (10,000개) =====
    # 찜 요리 (2,000개)
    "5-1:갈비찜:찜:일상:소고기:찜:100"
    "5-2:돼지갈비찜:찜:일상:돼지고기:찜:100"
    "5-3:닭찜:찜:일상:닭고기:찜:100"
    "5-4:계란찜:찜:초스피드:계란:찜:100"
    "5-5:해물찜:찜:일상:해물:찜:100"
    "5-6:아귀찜:찜:일상:아귀:찜:100"
    "5-7:꽃게찜:찜:일상:게:찜:100"
    "5-8:대게찜:찜:일상:게:찜:100"
    "5-9:조개찜:찜:일상:조개류:찜:100"
    "5-10:전복찜:찜:일상:전복:찜:100"
    "5-11:생선찜:찜:일상:생선류:찜:100"
    "5-12:가오리찜:찜:일상:가오리:찜:100"
    "5-13:동태찜:찜:일상:생선류:찜:100"
    "5-14:명태찜:찜:일상:생선류:찜:100"
    "5-15:고등어찜:찜:일상:생선류:찜:100"
    "5-16:돔찜:찜:일상:생선류:찜:100"
    "5-17:대구찜:찜:일상:생선류:찜:100"
    "5-18:감자찜:찜:일상:감자:찜:100"
    "5-19:고구마찜:찜:일상:고구마:찜:100"
    "5-20:호박찜:찜:일상:호박:찜:100"
    
    # 튀김/전 (3,000개)
    "5-21:닭강정:튀김:일상:닭고기:튀김:100"
    "5-22:양념치킨:튀김:일상:닭고기:튀김:100"
    "5-23:후라이드치킨:튀김:일상:닭고기:튀김:100"
    "5-24:간장치킨:튀김:일상:닭고기:튀김:100"
    "5-25:마늘치킨:튀김:일상:닭고기:튀김:100"
    "5-26:탕수육:튀김:일상:돼지고기:튀김:100"
    "5-27:깐풍기:튀김:일상:닭고기:튀김:100"
    "5-28:라조기:튀김:일상:닭고기:튀김:100"
    "5-29:생선튀김:튀김:일상:생선류:튀김:100"
    "5-30:야채튀김:튀김:일상:야채:튀김:100"
    "5-31:새우튀김:튀김:일상:새우:튀김:100"
    "5-32:오징어튀김:튀김:일상:오징어:튀김:100"
    "5-33:치킨너겟:튀김:일상:닭고기:튀김:100"
    "5-34:돈까스:튀김:일상:돼지고기:튀김:100"
    "5-35:치즈돈까스:튀김:일상:돼지고기:튀김:100"
    "5-36:김치전:부침:일상:김치:부침:100"
    "5-37:파전:부침:일상:파:부침:100"
    "5-38:해물파전:부침:일상:해물:부침:100"
    "5-39:빈대떡:부침:일상:녹두:부침:100"
    "5-40:감자전:부침:일상:감자:부침:100"
    "5-41:호박전:부침:일상:호박:부침:100"
    "5-42:부추전:부침:일상:부추:부침:100"
    "5-43:동그랑땡:부침:일상:고기:부침:100"
    "5-44:육전:부침:일상:소고기:부침:100"
    "5-45:생선전:부침:일상:생선류:부침:100"
    "5-46:버섯전:부침:일상:버섯:부침:100"
    "5-47:고추전:부침:일상:고추:부침:100"
    "5-48:깻잎전:부침:일상:깻잎:부침:100"
    "5-49:두부전:부침:일상:두부:부침:100"
    "5-50:계란말이:부침:초스피드:계란:부침:100"
    
    # 장아찌/절임/젓갈 (2,000개)
    "5-51:무장아찌:밑반찬:일상:무:절임:100"
    "5-52:오이장아찌:밑반찬:일상:오이:절임:100"
    "5-53:마늘장아찌:밑반찬:일상:마늘:절임:100"
    "5-54:양파장아찌:밑반찬:일상:양파:절임:100"
    "5-55:깻잎장아찌:밑반찬:일상:깻잎:절임:100"
    "5-56:고추장아찌:밑반찬:일상:고추:절임:100"
    "5-57:더덕장아찌:밑반찬:일상:더덕:절임:100"
    "5-58:도라지장아찌:밑반찬:일상:도라지:절임:100"
    "5-59:마늘쫑장아찌:밑반찬:일상:마늘종:절임:100"
    "5-60:고추가루장아찌:밑반찬:일상:고추:절임:100"
    "5-61:새우젓:밑반찬:일상:새우:절임:100"
    "5-62:멸치젓:밑반찬:일상:멸치:절임:100"
    "5-63:명란젓:밑반찬:일상:명란:절임:100"
    "5-64:창란젓:밑반찬:일상:명태:절임:100"
    "5-65:조기젓:밑반찬:일상:조기:절임:100"
    "5-66:황석어젓:밑반찬:일상:황석어:절임:100"
    "5-67:갈치속젓:밑반찬:일상:갈치:절임:100"
    "5-68:오징어젓:밑반찬:일상:오징어:절임:100"
    "5-69:게장:밑반찬:일상:게:절임:100"
    "5-70:간장게장:밑반찬:일상:게:절임:100"
    
    # 무침/조림 (3,000개)
    "5-71:멸치볶음:밑반찬:일상:멸치:볶음:100"
    "5-72:어묵볶음:밑반찬:일상:어묵:볶음:100"
    "5-73:장조림:밑반찬:일상:소고기:조림:100"
    "5-74:북어채무침:밑반찬:일상:북어:무침:100"
    "5-75:오징어채무침:밑반찬:일상:오징어:무침:100"
    "5-76:멍게무침:밑반찬:일상:멍게:무침:100"
    "5-77:해파리무침:밑반찬:일상:해파리:무침:100"
    "5-78:묵무침:밑반찬:초스피드:도토리묵:무침:100"
    "5-79:청포묵무침:밑반찬:초스피드:청포묵:무침:100"
    "5-80:김무침:밑반찬:초스피드:김:무침:100"
    "5-81:파래무침:밑반찬:초스피드:파래:무침:100"
    "5-82:톳무침:밑반찬:일상:톳:무침:100"
    "5-83:미역줄기무침:밑반찬:일상:미역:무침:100"
    "5-84:다시마무침:밑반찬:일상:다시마:무침:100"
    "5-85:무생채:밑반찬:초스피드:무:무침:100"
    "5-86:배추겉절이:밑반찬:초스피드:배추:무침:100"
    "5-87:상추겉절이:밑반찬:초스피드:상추:무침:100"
    "5-88:열무김치:김치:일상:열무:무침:100"
    "5-89:갓김치:김치:일상:갓:절임:100"
    "5-90:깍두기:김치:일상:무:절임:100"
    "5-91:총각김치:김치:일상:무:절임:100"
    "5-92:파김치:김치:일상:파:절임:100"
    "5-93:오이소박이:김치:일상:오이:절임:100"
    "5-94:나박김치:김치:일상:무:절임:100"
    "5-95:동치미:김치:일상:무:절임:100"
    "5-96:보쌈김치:김치:일상:배추:절임:100"
    "5-97:백김치:김치:일상:배추:절임:100"
    "5-98:배추김치:김치:일상:배추:절임:100"
    "5-99:포기김치:김치:일상:배추:절임:100"
    "5-100:잡채:밑반찬:일상:당면:볶음:100"
    
    # ===== Phase 6: 디저트/음료/빵 (10,000개) =====
    # 디저트 (3,000개)
    "6-1:케이크:디저트:일상:빵:굽기:100"
    "6-2:초콜릿케이크:디저트:일상:빵:굽기:100"
    "6-3:치즈케이크:디저트:일상:빵:굽기:100"
    "6-4:티라미수:디저트:일상:빵:만들기:100"
    "6-5:마카롱:디저트:일상:빵:굽기:100"
    "6-6:쿠키:디저트:일상:빵:굽기:100"
    "6-7:초코칩쿠키:디저트:일상:빵:굽기:100"
    "6-8:마들렌:디저트:일상:빵:굽기:100"
    "6-9:휘낭시에:디저트:일상:빵:굽기:100"
    "6-10:브라우니:디저트:일상:빵:굽기:100"
    "6-11:스콘:디저트:일상:빵:굽기:100"
    "6-12:머핀:디저트:일상:빵:굽기:100"
    "6-13:컵케이크:디저트:일상:빵:굽기:100"
    "6-14:마카롱:디저트:일상:빵:굽기:100"
    "6-15:푸딩:디저트:일상:우유:만들기:100"
    "6-16:크림브륄레:디저트:일상:우유:만들기:100"
    "6-17:판나코타:디저트:일상:우유:만들기:100"
    "6-18:아이스크림:디저트:일상:우유:만들기:100"
    "6-19:셔벗:디저트:일상:과일:얼리기:100"
    "6-20:젤라또:디저트:일상:우유:만들기:100"
    "6-21:와플:디저트:일상:밀가루:굽기:100"
    "6-22:팬케이크:디저트:초스피드:밀가루:부침:100"
    "6-23:핫케이크:디저트:초스피드:밀가루:부침:100"
    "6-24:프렌치토스트:디저트:초스피드:빵:굽기:100"
    "6-25:호떡:디저트:일상:밀가루:부침:100"
    "6-26:붕어빵:디저트:일상:밀가루:굽기:100"
    "6-27:계란빵:디저트:일상:밀가루:굽기:100"
    "6-28:크로플:디저트:일상:빵:굽기:100"
    "6-29:크로와상:디저트:일상:빵:굽기:100"
    "6-30:페이스트리:디저트:일상:빵:굽기:100"
    
    # 빵/베이커리 (3,000개)
    "6-31:식빵:디저트:일상:빵:굽기:100"
    "6-32:바게트:디저트:일상:빵:굽기:100"
    "6-33:소보로빵:디저트:일상:빵:굽기:100"
    "6-34:단팥빵:디저트:일상:빵:굽기:100"
    "6-35:크림빵:디저트:일상:빵:굽기:100"
    "6-36:야채빵:디저트:일상:빵:굽기:100"
    "6-37:치즈빵:디저트:일상:빵:굽기:100"
    "6-38:마늘빵:디저트:일상:빵:굽기:100"
    "6-39:베이글:디저트:일상:빵:굽기:100"
    "6-40:프레첼:디저트:일상:빵:굽기:100"
    "6-41:시나몬롤:디저트:일상:빵:굽기:100"
    "6-42:도넛:디저트:일상:빵:튀김:100"
    "6-43:크림도넛:디저트:일상:빵:튀김:100"
    "6-44:찹쌀도넛:디저트:일상:빵:튀김:100"
    "6-45:츄러스:디저트:일상:빵:튀김:100"
    "6-46:피자:일품요리:일상:빵:굽기:100"
    "6-47:치즈피자:일품요리:일상:빵:굽기:100"
    "6-48:페퍼로니피자:일품요리:일상:빵:굽기:100"
    "6-49:야채피자:일품요리:일상:빵:굽기:100"
    "6-50:불고기피자:일품요리:일상:빵:굽기:100"
    "6-51:새우피자:일품요리:일상:빵:굽기:100"
    "6-52:고구마피자:일품요리:일상:빵:굽기:100"
    "6-53:포테이토피자:일품요리:일상:빵:굽기:100"
    "6-54:마르게리따:일품요리:일상:빵:굽기:100"
    "6-55:하와이안피자:일품요리:일상:빵:굽기:100"
    "6-56:콤비네이션피자:일품요리:일상:빵:굽기:100"
    "6-57:고르곤졸라피자:일품요리:일상:빵:굽기:100"
    "6-58:트러플피자:일품요리:일상:빵:굽기:100"
    "6-59:브루스케타:디저트:일상:빵:굽기:100"
    "6-60:포카치아:디저트:일상:빵:굽기:100"
    
    # 음료/스무디 (2,000개)
    "6-61:커피:음료:초스피드:커피:만들기:100"
    "6-62:아메리카노:음료:초스피드:커피:만들기:100"
    "6-63:라떼:음료:초스피드:커피:만들기:100"
    "6-64:카푸치노:음료:초스피드:커피:만들기:100"
    "6-65:카페모카:음료:초스피드:커피:만들기:100"
    "6-66:바닐라라떼:음료:초스피드:커피:만들기:100"
    "6-67:카라멜마끼아또:음료:초스피드:커피:만들기:100"
    "6-68:녹차라떼:음료:초스피드:녹차:만들기:100"
    "6-69:홍차:음료:초스피드:차:끓이기:100"
    "6-70:얼그레이:음료:초스피드:차:끓이기:100"
    "6-71:허브티:음료:초스피드:차:끓이기:100"
    "6-72:과일차:음료:초스피드:과일:끓이기:100"
    "6-73:생강차:음료:초스피드:생강:끓이기:100"
    "6-74:유자차:음료:초스피드:유자:만들기:100"
    "6-75:대추차:음료:초스피드:대추:끓이기:100"
    "6-76:쌍화차:음료:일상:한약재:끓이기:100"
    "6-77:수정과:음료:일상:계피:끓이기:100"
    "6-78:식혜:음료:일상:엿기름:만들기:100"
    "6-79:매실차:음료:초스피드:매실:만들기:100"
    "6-80:모과차:음료:초스피드:모과:끓이기:100"
    "6-81:스무디:음료:초스피드:과일:갈기:100"
    "6-82:딸기스무디:음료:초스피드:딸기:갈기:100"
    "6-83:바나나스무디:음료:초스피드:바나나:갈기:100"
    "6-84:망고스무디:음료:초스피드:망고:갈기:100"
    "6-85:블루베리스무디:음료:초스피드:블루베리:갈기:100"
    "6-86:키위스무디:음료:초스피드:키위:갈기:100"
    "6-87:아보카도스무디:음료:초스피드:아보카도:갈기:100"
    "6-88:녹즙:음료:초스피드:야채:갈기:100"
    "6-89:주스:음료:초스피드:과일:갈기:100"
    "6-90:오렌지주스:음료:초스피드:오렌지:갈기:100"
    "6-91:사과주스:음료:초스피드:사과:갈기:100"
    "6-92:포도주스:음료:초스피드:포도:갈기:100"
    "6-93:토마토주스:음료:초스피드:토마토:갈기:100"
    "6-94:당근주스:음료:초스피드:당근:갈기:100"
    "6-95:에이드:음료:초스피드:과일:만들기:100"
    "6-96:레몬에이드:음료:초스피드:레몬:만들기:100"
    "6-97:자몽에이드:음료:초스피드:자몽:만들기:100"
    "6-98:청포도에이드:음료:초스피드:포도:만들기:100"
    "6-99:밀크쉐이크:음료:초스피드:우유:만들기:100"
    "6-100:초코쉐이크:음료:초스피드:우유:만들기:100"
    
    # 한식 떡/전통 디저트 (2,000개)
    "6-101:떡:디저트:일상:떡:찌기:100"
    "6-102:인절미:디저트:일상:떡:찌기:100"
    "6-103:송편:디저트:일상:떡:찌기:100"
    "6-104:경단:디저트:일상:떡:찌기:100"
    "6-105:백설기:디저트:일상:떡:찌기:100"
    "6-106:팥떡:디저트:일상:떡:찌기:100"
    "6-107:쑥떡:디저트:일상:떡:찌기:100"
    "6-108:절편:디저트:일상:떡:찌기:100"
    "6-109:증편:디저트:일상:떡:찌기:100"
    "6-110:약식:디저트:일상:밥:찌기:100"
    "6-111:유과:디저트:일상:밀가루:튀김:100"
    "6-112:강정:디저트:일상:밀가루:튀김:100"
    "6-113:한과:디저트:일상:밀가루:만들기:100"
    "6-114:다식:디저트:일상:꿀:만들기:100"
    "6-115:정과:디저트:일상:과일:조림:100"
    "6-116:숙실과:디저트:일상:대추:만들기:100"
    "6-117:엿:디저트:일상:엿기름:만들기:100"
    "6-118:빙수:디저트:일상:얼음:만들기:100"
    "6-119:팥빙수:디저트:일상:얼음:만들기:100"
    "6-120:과일빙수:디저트:일상:얼음:만들기:100"
)

TOTAL=${#COLLECTIONS[@]}
CURRENT=0
TOTAL_RECIPES=0
START_TIME=$(date +%s)

log_info "총 ${TOTAL}개 배치 작업 (500개 배치)"
log_info "예상 수집: $((TOTAL * 100))개 = 50,000개 레시피"
log_info "예상 소요 시간: 약 50-60시간 (2-3일)"
log_info ""
log_warning "⚠️  초장시간 작업입니다! 컴퓨터가 꺼지지 않도록 주의하세요!"
log_warning "⚠️  Screen 또는 Tmux 사용을 강력히 권장합니다!"
log_warning "⚠️  중간에 중단하려면 Ctrl+C를 누르세요."
echo ""
read -p "계속하시겠습니까? (y/N): " confirm
if [[ ! $confirm =~ ^[Yy]$ ]]; then
    log_error "작업 취소"
    exit 0
fi

# 메인 루프
for collection in "${COLLECTIONS[@]}"; do
    CURRENT=$((CURRENT + 1))
    
    IFS=':' read -r phase name type situation ingredient method count <<< "$collection"
    
    echo ""
    log_info "=========================================="
    log_info "[$CURRENT/$TOTAL] Phase $phase: $name"
    log_info "=========================================="
    log_info "Type: $type | Situation: $situation"
    log_info "Ingredient: $ingredient | Method: $method"
    log_info "Count: $count"
    log_info ""
    
    # .env 파일 업데이트
    sed -i "s|^RECIPE_TYPE=.*|RECIPE_TYPE=$type|" config/.env
    sed -i "s|^RECIPE_SITUATION=.*|RECIPE_SITUATION=$situation|" config/.env
    sed -i "s|^RECIPE_INGREDIENT=.*|RECIPE_INGREDIENT=$ingredient|" config/.env
    sed -i "s|^RECIPE_METHOD=.*|RECIPE_METHOD=$method|" config/.env
    sed -i "s|^MAX_RECIPES=.*|MAX_RECIPES=$count|" config/.env
    
    # 실행
    BATCH_START=$(date +%s)
    
    if python main.py --no-prompt 2>&1 | tee "logs/batch_50k_${phase}_${name}.log"; then
        BATCH_END=$(date +%s)
        BATCH_TIME=$((BATCH_END - BATCH_START))
        TOTAL_RECIPES=$((TOTAL_RECIPES + count))
        
        log_success "Phase $phase 완료! (소요: ${BATCH_TIME}초 = $((BATCH_TIME/60))분)"
        
        # 현재 통계
        CURRENT_TIME=$(date +%s)
        ELAPSED=$((CURRENT_TIME - START_TIME))
        AVG_TIME=$((ELAPSED / CURRENT))
        REMAINING=$((TOTAL - CURRENT))
        ETA=$((AVG_TIME * REMAINING))
        
        log_info "진행: $CURRENT/$TOTAL 완료 ($((CURRENT*100/TOTAL))%)"
        log_info "수집: $TOTAL_RECIPES개 레시피"
        log_info "경과: $((ELAPSED/3600))시간 $((ELAPSED%3600/60))분"
        log_info "예상 남은 시간: $((ETA/3600))시간 $((ETA%3600/60))분"
        
        # 백업 (5000개마다)
        if [ $((TOTAL_RECIPES % 5000)) -eq 0 ]; then
            log_info "🔥 대규모 백업 생성 중... ($TOTAL_RECIPES개)"
            pg_dump -h localhost -U recipe_keep recipe_ai_db > "backups/backup_50k_${TOTAL_RECIPES}_$(date +%Y%m%d_%H%M%S).sql" 2>/dev/null || true
            log_success "백업 완료"
        fi
        
        # 잠시 대기
        log_info "다음 배치까지 5초 대기..."
        sleep 5
    else
        log_error "Phase $phase 실패!"
        log_warning "계속하시겠습니까? (y/N)"
        read -p "> " continue_on_error
        if [[ ! $continue_on_error =~ ^[Yy]$ ]]; then
            log_error "작업 중단 (현재까지 수집: $TOTAL_RECIPES개)"
            exit 1
        fi
    fi
done

# 최종 통계
END_TIME=$(date +%s)
TOTAL_TIME=$((END_TIME - START_TIME))

echo ""
log_success "=========================================="
log_success "  🎉 50,000개 레시피 수집 완료!"
log_success "=========================================="
log_success "총 수집: $TOTAL_RECIPES개 레시피"
log_success "총 시간: $((TOTAL_TIME/3600))시간 $((TOTAL_TIME%3600/60))분"
log_success "평균: $((TOTAL_TIME/TOTAL_RECIPES))초/레시피"
log_success "=========================================="

# DB 통계
log_info ""
log_info "DB 최종 통계:"
psql -h localhost -d recipe_ai_db -U recipe_keep -c "
SELECT 
    COUNT(*) as total_recipes,
    (SELECT COUNT(*) FROM ingredients) as total_ingredients,
    (SELECT COUNT(*) FROM cooking_steps) as total_steps,
    (SELECT COUNT(*) FROM recipes WHERE embedding IS NOT NULL) as vectorized_recipes
FROM recipes;
" 2>&1 | grep -v "^$"

# 최종 백업
log_info ""
log_info "🔥 최종 대규모 백업 생성 중..."
pg_dump -h localhost -U recipe_keep recipe_ai_db > "backups/final_50k_$(date +%Y%m%d_%H%M%S).sql" 2>/dev/null || true
log_success "최종 백업 완료"

log_info ""
log_success "🎉🎉🎉 50,000개 레시피 대규모 DB 구축 완료!"
log_success "✅ 다음 단계: 벡터화 (python vectorize_recipes.py)"
log_success "✅ 예상 벡터화 시간: 약 10-15시간"

